function nl2br(a,b){var c=b||"undefined"==typeof b?"<br />":"<br>";return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+c+"$2")}function escapeHtml(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var com=com||{};com.shabbtech=com.shabbtech||{},com.shabbtech.wedding=com.shabbtech.wedding||{},com.shabbtech.wedding.gallery=com.shabbtech.wedding.gallery||function(){"use strict";var a,b,c,d,e,f=function(){g.call(this),d={},d.onUploadExitComplete=jQuery.proxy(n,this)},g=function(){c=jQuery("#main"),e=c.find("#upload"),c.find(".gallery_list > li").click(j),c.find(".images .back a").click(h),c.find(".upload_indicator").click(l),c.find("#upload .exit").click(m)},h=function(c){c.preventDefault(),b=jQuery(c.currentTarget).parents(".images"),a=b.siblings(".gallery_list"),b.fadeOut({duration:500,easing:"easeInQuart",complete:i})},i=function(){a.fadeIn({duration:500,easing:"easeInQuart"})},j=function(c){var d=jQuery(c.currentTarget);a=d.parents(".gallery_list"),b=a.siblings(".images"),a.fadeOut({duration:500,easing:"easeInQuart",complete:k});var e=b.find("ul.image_list[data-id="+d.data("id")+"]");0===e.length?jQuery.ajax("/service/s.images.php",{type:"POST",data:{id:d.data("id"),location:b.data("location")},complete:function(a){b.append(a.responseText)}}):setTimeout(function(){e.show(),b.fadeIn()},500)},k=function(){b.fadeIn({duration:500,easing:"easeInQuart"})},l=function(a){var b=jQuery(a.currentTarget).parents(".content").find(".gallery_list").data("location");e.find("select[name=location] option[value="+b+"]").prop("selected",!0),e.show().css({top:-1e3}),e.animate({top:0},{duration:1200,easing:"easeOutBounce"})},m=function(){e.animate({top:1e3},{duration:600,easing:"easeOutBounce",complete:d.onUploadExitComplete}),jQuery.ajax("/service/s.gallery.php",{complete:function(a){var b=jQuery(a.responseText),c=jQuery("ul.gallery_list");b.each(function(a,b){var d=jQuery(b),e=d.data("id"),f=d.data("location"),g=c.filter("[data-location="+f+"]");0===g.children().filter("[data-id="+e+"]").length&&(g.append(d),d.click(j))})}})},n=function(){e.hide().css("top",-1e3)};return f}();var com=com||{};com.shabbtech=com.shabbtech||{},com.shabbtech.wedding=com.shabbtech.wedding||{},com.shabbtech.wedding.guestbook=com.shabbtech.wedding.guestbook||function(){"use strict";var a,b,c,d,e,f,g=function(){a=jQuery("#main"),b={},b.onGuestbookEntryClick=jQuery.proxy(j,this),b.onGuestbookEntryPosted=jQuery.proxy(k,this),Page.init(jQuery.proxy(h,this)),i()},h=function(a,b){var g=e.find(".bb-item"),h=g.eq(c-1).find("form"),i=g.eq(b).find("form");i.find("input[name=name]").val(h.find("input[name=name]").val()),i.find("textarea[name=msg]").val(h.find("textarea[name=msg]").val()),c=b+1,f.find(".page-count").text("Seite "+c+" von "+d),g.find(".error").removeClass("error")},i=function(){a.find(".guestbook_form input[type=submit]").click(b.onGuestbookEntryClick),e=a.find("#bb-bookblock"),e.find("form").keydown(function(a){var b=a.keyCode||a.which;(37==b||39==b)&&a.stopPropagation()}),f=a.find("#bb-nav"),c=1,d=e.children().length-1,f.find(".page-count").text("Seite "+c+" von "+d)},j=function(a){a.preventDefault();var c=jQuery(a.currentTarget),d=c.parents(".guestbook_form"),e=d.find("textarea[name=msg]").val(),f=d.find("input[name=name]").val();jQuery.ajax("/service/s.guestbook.php",{dataType:"json",type:"POST",data:{name:f,msg:e},complete:b.onGuestbookEntryPosted})},k=function(a){var b=jQuery(".bb-item"),g=a.responseJSON;if(200===a.status){var h=b.eq(0).clone();h.find(".name").text(g.name),h.find(".date").text(g.date),h.find(".msg_container").html(nl2br(escapeHtml(g.msg),!0)),b.eq(0).parent().prepend(h),d++,c=1,f.find(".page-count").text("Seite "+c+" von "+d),b.find(".error").removeClass("error"),e.bookblock("update"),e.bookblock("first")}else for(var i=0;i<g.errorFields.length;i++)"name"===g.errorFields[i]?b.eq(c-1).find("input[name=name]").addClass("error"):"msg"===g.errorFields[i]&&b.eq(c-1).find("textarea[name=msg]").addClass("error")};return g}();var Page=function(){var a,b={$bookBlock:$("#bb-bookblock"),$navNext:$("#bb-nav-next"),$navPrev:$("#bb-nav-prev"),$navFirst:$("#bb-nav-first"),$navLast:$("#bb-nav-last"),onPageChange:null},c=function(c){a=c,b.$bookBlock.bookblock({speed:800,shadowSides:.8,shadowFlip:.7,onEndFlip:c}),d()},d=function(){b.$bookBlock.children(),b.$navNext.on("click touchstart",function(){return b.$bookBlock.bookblock("next"),!1}),b.$navPrev.on("click touchstart",function(){return b.$bookBlock.bookblock("prev"),!1}),b.$navFirst.on("click touchstart",function(){return b.$bookBlock.bookblock("first"),!1}),b.$navLast.on("click touchstart",function(){return b.$bookBlock.bookblock("last"),!1}),$(document).keydown(function(a){var c=a.keyCode||a.which,d={left:37,up:38,right:39,down:40};switch(c){case d.left:b.$bookBlock.bookblock("prev");break;case d.right:b.$bookBlock.bookblock("next")}})};return{init:c}}(),com=com||{};com.shabbtech=com.shabbtech||{},com.shabbtech.wedding=com.shabbtech.wedding||{},com.shabbtech.wedding.intro=com.shabbtech.wedding.intro||function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=!1,o=function(a){p(),this.main=a},p=function(){a=jQuery("body"),e=a.find("#main"),d=a.find("#intro"),c=d.find("#intro_txt"),m=a.find("#logo"),f=a.find("#copyright"),b=m.find(".mountains"),g={},g.green=m.find(".bird.green"),g.yellow=m.find(".bird.yellow"),h=d.find(".skip"),i=jQuery("#main_navigation"),l=jQuery(".video_bg video")[0],k=jQuery("#audio_container"),j=k.find("#audio_player")[0],h.click(q),d.show(),a.css("background-color","#FFFFFF"),b.css("bottom",-b.show().height()),b.on("dragstart",function(a){a.preventDefault()}),d.hide(),f.css("bottom",-200)};o.prototype.start=function(){j.volume=.1,j.play(),d.show(),m.css("height",jQuery(window).innerHeight()),g.green.css({bottom:-g.green.height(),left:"60%"}),g.yellow.css({bottom:-g.yellow.height(),left:0}),a.animate({"background-color":"#fff7e2"},3500),b.animate({bottom:"-5%"},2500,"easeOutQuad"),c.animate({"font-size":"1.8em",color:"#484647",top:0},7e3,"easeOutQuad"),setTimeout(function(){n||(g.green.animate({bottom:b.height()/2.1,left:"38%"},4050),g.yellow.animate({bottom:b.height()/2,left:"25%"},4e3))},2500),setTimeout(function(){n||(b.animate({width:345.6,bottom:"0"},2500,"easeOutQuad"),c.animate({"font-size":"0.2em",color:"#484647",top:"30%",opacity:0},2500,"easeOutQuad"),g.green.animate({bottom:85,left:130,width:47},2500,"easeOutQuad"),g.yellow.animate({bottom:87,left:85,width:44},2500,"easeOutQuad"),jQuery(l).fadeIn()[0].play())},7e3),setTimeout(function(){n||(i.animate({"margin-top":0},500),f.animate({bottom:20},500),h.fadeOut(),g.green.add(g.yellow).click(r))},7800)};var q=function(){i.animate({"margin-top":0},500),d.fadeOut(),e.fadeIn(),b.stop().css({width:345.6,bottom:"0"}),g.green.stop().css({bottom:85,left:130,width:47}),g.yellow.stop().css({bottom:87,left:85,width:44}),jQuery(l).fadeIn()[0].play(),n=!0,g.green.add(g.yellow).click(r)},r=function(){l.paused?l.play():l.pause()};return o}(),com.shabbtech.global.namespace("com.shabbtech.wedding").main=com.shabbtech.global.namespace("com.shabbtech.wedding ").main||function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l=function(){try{m.call(this)}catch(a){console.error("Error @ Main initialization",a)}},m=function(){a=jQuery("body"),c=a.find("#main"),k=c.find("#pages"),b=new com.shabbtech.wedding.intro(this),d=new com.shabbtech.wedding.navigation,g=new com.shabbtech.wedding.gallery,h=new com.shabbtech.wedding.guestbook,f={},f.onVideoThumbClick=jQuery.proxy(p,this),f.onWindowResize=jQuery.proxy(q,{root:a.find("#root"),nav:d,pages:k}),e=!1,j=a.find("#audio_container"),i=j.find("#audio_player")[0],c.height(jQuery(window).innerHeight()),a.find("video").not(".background_video").on("play",o),c.find(".video_list > li").click(f.onVideoThumbClick),j.find(".play_pause").click(n),b.start(1e4),Modernizr.touch&&(j.find(".play_pause").text("play"),jQuery(".video_bg").remove()),com.shabbtech.resize.addFunction(f.onWindowResize),f.onWindowResize()},n=function(){i.paused?(j.find(".play_pause").text("pause"),i.play()):(j.find(".play_pause").text("play"),i.pause())},o=function(a){var b=jQuery(a.currentTarget);b[0].paused||i.paused||(j.find(".play_pause").text("play"),i.pause())},p=function(a){var b=jQuery(a.currentTarget),c=b.parents(".content"),d=c.find(".video_container"),e=d.find("video"),f=b.data("poster-path"),g=b.data("file-path");c.find(".video_list > li").removeClass("active"),b.addClass("active"),d.find(".info .size").text(b.data("size")),d.find(".info .duration").text(b.data("duration")),d.find(".info a").attr("href",g),d.find("h2").text(b.find(".name").text()),e.attr("poster",f),e.find("source").attr("src",g),e.load()},q=function(){var b=jQuery(".wrapper.active"),d=jQuery("#guestbook.active");this.root.height(jQuery(window).innerHeight()),this.root.css("overflow",(b.length>0&&a.height()<b.height()+b.offset().top?"auto":"hidden")||(d.length>0&&a.height()<d.outerHeight(!0)+d.offset().top?"auto":"hidden")),b.length>0?c.css("height",b.height()+b.offset().top):d.length>0&&c.css("height",d.outerHeight(!0)+d.offset().top);var e=3.5*a.width()/1024;e=e>3.5?3.5:e,this.nav.Lvl1Wrapper.css("font-size",e+"em"),a.find(".bg_title").css("font-size",e+"em"),a.find(".bg_date").css("font-size",e/2+"em"),a.find("#copyright").css("font-size",e/3+"em");var f=this.nav.Lvl1Wrapper.outerHeight(!0)+this.nav.Lvl2Wrapper.outerHeight(!0);this.pages.css("padding-top",f);var g=a.find(".video_container"),h=-g.find("video:visible").width()/2;a.find(".video_container.solo").find("h2, .info").filter(":visible").css("margin-left",h)};return l}(),com.shabbtech.resize=new(function(){"use strict";var a,b=250,c=!1,d=jQuery(window),e=function(){a=[],c=!1,d.resize(f)};e.prototype.addFunction=function(b,c){return b instanceof Function?(a.push({fkt:b,condition:c}),!0):!1},e.prototype.clear=function(){a=[]};var f=function(){c=!0,window.setTimeout(g,b),d.unbind("resize",f)},g=function(){if(c){for(var b=0;b<a.length;b++)(!(a[b].condition instanceof Function)||a[b].condition instanceof Function&&a[b].condition(d))&&a[b].fkt();d.resize(f)}};return e}()),jQuery(window).load(function(){new com.shabbtech.wedding.main});var com=com||{};com.shabbtech=com.shabbtech||{},com.shabbtech.wedding=com.shabbtech.wedding||{},com.shabbtech.wedding.navigation=com.shabbtech.wedding.navigation||function(){"use strict";var a,b,c,d,e,f,g,h,i=0,j=1,k=1e3,l=!1,m=function(){e={},e.onLinkClickProxy=jQuery.proxy(r,this),e.onContentAnimationCompleteProxy=jQuery.proxy(v,this),n.call(this)},n=function(){return h=jQuery("#root"),a=h.find("#main"),g=a.find("#main_navigation"),d=[],b=g.find(".lvl1.wrapper"),this.Lvl1Wrapper=b,c=this.Lvl1Wrapper.find(".lvl2"),this.Lvl2Wrapper=c,f=c.find(">li"),c.each(function(a,b){var c=jQuery(b).show();c.css("bottom",c.height())}),f.add(g.find(".link")).click(e.onLinkClickProxy),b.each(function(a,c){var e=b.index(c);d[e]=[],d[e][i]=!1,d[e][j]=!1}),Modernizr.touch?b.click(o):b.hover(p,q),this},o=function(a){var b=jQuery(a.currentTarget);b.hasClass("touch_active")?(q(a),b.removeClass("touch_active")):(p(a),b.addClass("touch_active"))},p=function(a){var c=jQuery(a.currentTarget),e=b.index(c);if(d[e][j]=!1,!d[e][j]){d[e][j]=!0,c.stop().animate({"background-color":"rgba(68, 68, 68, 0.4)",color:"#fff7e2"});var f=c.find(".lvl2");f.show(),f.stop().animate({bottom:-f.height(),opacity:1},800,"easeOutExpo")}},q=function(a){var c=jQuery(a.currentTarget),e=b.index(c);if(d[e][i]=!1,!d[e][i]){d[e][i]=!0,b.filter(".active").stop().animate({"background-color":"rgba(0,0,0, 0.1)",color:"#444444"}),b.not(".active").stop().animate({"background-color":"transparent",color:"#444444"});var f=c.find(".lvl2");f.stop().animate({bottom:0,opacity:0},800,"easeOutExpo")}},r=function(c){if(!l){var d=jQuery("#main_navigation .lvl2 > li.active"),e=d.parent().find(">li").index(d),g=jQuery(c.currentTarget);if(!(d.is(g)||"guestbook"===g.data("rel")&&"guestbook"===jQuery("#pages").children().filter(".active").attr("id"))){l=!0,f.removeClass("active"),b.removeClass("active"),g.parents(".lvl1 .wrapper").addClass("active"),g.addClass("active");var i=g.hasClass("category")?g:g.parents(".category"),j=i.find(".lvl2 > li"),k=j.index(g);this.oldContentCategory=this.newContentCategory||jQuery(),this.oldContent=this.newContent||jQuery(),this.newContentCategory=a.find("#"+i.data("rel")),this.newContent=this.newContentCategory.find(".wrapper").eq(k),this.newContent.addClass("active"),s.call(this,e,k),h.css("overflow","hidden")}}},s=function(a,b){var c,d=1e3;this.newContentCategory.addClass("active"),0===this.oldContentCategory.length?($(window).trigger("resize"),"guestbook"===this.newContentCategory.attr("id")?this.newContentCategory.css({"margin-top":-d,opacity:0}):this.newContentCategory.css({"margin-top":d,opacity:0}),this.newContentCategory.stop().animate({"margin-top":0,opacity:1},k,e.onContentAnimationCompleteProxy),this.oldContentCategory.stop().animate({"margin-top":-d},k,e.onContentAnimationCompleteProxy)):"guestbook"===this.newContentCategory.attr("id")?(this.newContentCategory.css({"margin-top":d,"margin-left":0}),this.newContentCategory.stop().animate({"margin-top":0},k,e.onContentAnimationCompleteProxy),this.oldContentCategory.stop().animate({"margin-top":-d},k,e.onContentAnimationCompleteProxy)):"guestbook"===this.oldContentCategory.attr("id")?(this.newContentCategory.css({"margin-top":-d,"margin-left":0}),this.newContentCategory.stop().animate({"margin-top":0},k,e.onContentAnimationCompleteProxy),this.oldContentCategory.stop().animate({"margin-top":d},k,e.onContentAnimationCompleteProxy)):this.newContentCategory.data("order")>this.oldContentCategory.data("order")?(this.newContentCategory.css({"margin-left":"100%","margin-top":0}),c={"new":{"margin-left":0},old:{"margin-left":"-100%"}},c=t.call(this,a,b,c,d),this.newContentCategory.stop().animate(c.new,k,e.onContentAnimationCompleteProxy),this.oldContentCategory.stop().animate(c.old,k,e.onContentAnimationCompleteProxy)):this.newContentCategory.data("order")<this.oldContentCategory.data("order")?(this.newContentCategory.css({"margin-left":"-100%","margin-top":0}),c={"new":{"margin-left":0},old:{"margin-left":"100%"}},c=t.call(this,a,b,c,d),this.newContentCategory.stop().animate(c.new,k,e.onContentAnimationCompleteProxy),this.oldContentCategory.stop().animate(c.old,k,e.onContentAnimationCompleteProxy)):(c={"new":{},old:{}},a>b?(this.newContent.css({"margin-top":-d,"margin-left":0}),c.new.marginTop=0,c.old.marginTop=d):b>a&&(this.newContent.css({"margin-top":d,"margin-left":0}),c.new.marginTop=0,c.old.marginTop=-d),this.newContent.stop().animate(c.new,k,e.onContentAnimationCompleteProxy),this.oldContent.stop().animate(c.old,k,e.onContentAnimationCompleteProxy),u.call(this,a,b))},t=function(a,b,c,d){return a!=b&&(this.newContent.find(".bg_color").addClass("extended"),this.oldContent.find(".bg_color").addClass("extended")),a>b?(this.newContentCategory.css({"margin-top":-d}),c.new.marginTop=0,c.old.marginTop=d):b>a&&(this.newContentCategory.css({"margin-top":d}),c.new.marginTop=0,c.old.marginTop=-d),u.call(this,a,b),c},u=function(a,b){var c=this.newContent.find(".bg_color");this.oldContent.find(".bg_color").hasClass("green")?a===b?c.addClass("green"):c.removeClass("green"):a===b?c.removeClass("green"):c.addClass("green")},v=function(){this.oldContent.removeClass("active"),this.oldContent.css("margin-top",0),this.newContent.siblings().removeClass("active"),this.newContent.find(".bg_color").removeClass("extended"),this.oldContent.find(".bg_color").removeClass("extended"),this.newContentCategory.is(this.oldContentCategory)||this.oldContentCategory.removeClass("active"),l=!1};return m}(),$(function(){function a(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" GB":a>=1e6?(a/1e6).toFixed(2)+" MB":(a/1e3).toFixed(2)+" KB"}var b=$("#upload ul");$("#drop a").click(function(){$(this).parent().find("input").click()});var c=[],d=jQuery("#triggerUpload");d.click(function(){var a=c[0].form.find("input[name=poster]");a.val().length<=0&&a.val(c[0].files[0].name);var d;b.children().filter(":hidden").remove(),c=c.reverse();for(var e=0;c.length>0;e++)d=c.pop(),d.context.hasClass("poster")&&d.form.find("input[name=poster]").val(d.files[0].name),d.form.find("input[name=index]").val(e),d.submit()}),$("#upload").fileupload({dropZone:$("#drop"),add:function(d,e){var f=jQuery("#triggerUpload");f.not(":visible")&&f.fadeIn();var g="";0===b.children().filter(":visible").length&&(g="poster",e.form.find("input[name=poster]").val(e.files[0].name));var h=$('<li class="working '+g+'"><div class="loading"></div><div class="img_info"><span class="name">peter.jpg</span><span class="size">123 x</span></div></li>');h.find(".name").text(e.files[0].name),h.find(".size").text(a(e.files[0].size)),h.click(function(){h.siblings().removeClass("poster"),h.addClass("poster")});var i=jQuery('<a href="#" class="remove">X</a>');i.click(function(a){a.preventDefault();var b=jQuery(a.currentTarget),d=b.parent();d.remove();for(var e=0;e<c.length;e++)d.is(c[e].context)&&c.splice(e,1)}),h.append(i),c.push(e),e.context=h.appendTo(b),h.find("span").click(function(){h.hasClass("working")&&jqXHR.abort(),h.fadeOut(function(){h.remove()})})},progress:function(a,b){var c=parseInt(100*(b.loaded/b.total),10);b.context.find(".loading").css("width",c+"%"),100==c&&b.context.removeClass("working")},complete:function(a){var b=a.responseText.match(/index":([0-9]+)\}/)[1];jQuery("#upload .preview_list > li").eq(b).fadeOut()},fail:function(a,b){b.context.addClass("error")}}),$(document).on("drop dragover",function(a){a.preventDefault()})});